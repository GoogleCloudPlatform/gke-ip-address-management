(this["webpackJsonpgke-net"]=this["webpackJsonpgke-net"]||[]).push([[0],{16:function(e,t,a){},20:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(4),l=a.n(r),o=(a(16),a(5),a(3));class i extends n.Component{constructor(e){super(e),this.createOptions=()=>{var e=[];return this.props.options.forEach((t=>{e.push(s.a.createElement("option",{value:t.value,key:t.value},t.text))})),e},this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.changeHandler(e.target.value)}render(){return""===this.props.value||null===this.props.value?s.a.createElement(o.f,{type:"select",name:this.props.name,id:this.props.id,onChange:this.handleChange},this.createOptions()):s.a.createElement(o.f,{type:"select",name:this.props.name,id:this.props.id,onChange:this.handleChange,value:this.props.value},this.createOptions())}}var u=i;class p extends n.Component{constructor(e){super(e),this.createOptions=()=>{for(var e=this.props.rules.minimum().minimum(),t=this.props.rules.maximum().maximum(),a=[],n=e;n>=t;n--)a.push(s.a.createElement("option",{value:n,key:n},"/",n));return a},this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.changeHandler(Number(e.target.value))}render(){return""===this.props.value||null===this.props.value?s.a.createElement(o.f,{type:"select",name:"select",id:"exampleSelect",onChange:this.handleChange},this.createOptions()):s.a.createElement(o.f,{type:"select",name:"select",id:"exampleSelect",onChange:this.handleChange,value:this.props.value},this.createOptions())}}var h=p;class c extends n.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.changeHandler(this.props.propName,e)}render(){return s.a.createElement(o.e,{row:!0},s.a.createElement(o.g,{for:"{this.props.name}",sm:3},this.props.label),s.a.createElement(o.b,{sm:2},s.a.createElement(h,{name:this.props.name,rules:this.props.rules,changeHandler:this.handleChange,value:this.props.value})))}}var m=c;class d extends n.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.changeHandler(this.props.propName,e)}render(){return s.a.createElement(o.e,{row:!0},s.a.createElement(o.g,{for:"{this.props.name}",sm:3},this.props.label),s.a.createElement(o.b,{sm:2},s.a.createElement(u,{name:this.props.name,id:this.props.name,options:this.props.options,value:this.props.value,changeHandler:this.handleChange})))}}var g=d,v=(e,t)=>null==e||t.maximum()>e.maximum()?t:e,E=(e,t)=>null==e||t.maximum()<e.maximum()?t:e;var k=class{constructor(e,t){this.minRules=e,this.maxRules=t}minimum(){return this.minRules.reduce(E)}maximum(){return this.maxRules.reduce(v)}};class b{minimum(){return 24}ref(){return"https://cloud.google.com/kubernetes-engine/docs/how-to/alias-ips#defaults_limits"}}class C{constructor(e){this.state=e}maximum(){return this.state.netmask}}var x=class extends k{constructor(e){super([new b],[new C(e)])}};class N{minimum(){return 29}ref(){return"https://cloud.google.com/vpc/docs/vpc#manually_created_subnet_ip_ranges"}}class w{constructor(e){this.state=e}maximum(){return this.state.netmask}}var f=class extends k{constructor(e){super([new N],[new w(e)])}};class R{minimum(){return 27}ref(){return"https://cloud.google.com/kubernetes-engine/docs/how-to/alias-ips#defaults_limits"}}class y{constructor(e){this.state=e}maximum(){return this.state.netmask}}var S=class extends k{constructor(e){super([new R],[new y(e)])}};class T{minimum(){return 29}}class U{maximum(){return 8}}var I=class extends k{constructor(){super([new T],[new U])}};class M{minimum(){return 28}}class A{maximum(){return 24}}var O=class extends k{constructor(){super([new M],[new A])}};var D=class{constructor(e){this.clusterRules=new x(e),this.nodeRules=new f(e),this.serviceRules=new S(e),this.availableNetmaskRules=new I,this.podRules=new O}getClusterRules(){return this.clusterRules}getNodeRules(){return this.nodeRules}getServiceRules(){return this.serviceRules}getAvailableNetmaskRules(){return this.availableNetmaskRules}getPodRules(){return this.podRules}},P=[{value:"ZONAL",text:"Zonal"},{value:"MULTI_ZONAL",text:"Multi - zonal"},{value:"REGIONAL",text:"Regional"}],L=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"}],_=[{value:"PUBLIC",text:"Public Master"},{value:"SHARE",text:"Share one Master CIDR across all clusters"},{value:"UNIQUE",text:"Create a Unique Master CIDR for each cluster"},{value:"DEFAULT",text:"Use default values for the Master CIDR block"}],H=[{value:"28",text:"8 pods (/28)",max:8},{value:"27",text:"9 to 16 pods (/27)",max:16},{value:"26",text:"17 to 32 pods (/26)",max:32},{value:"25",text:"33 to 64 pods (/25)",max:64},{value:"24",text:"65 to 110 pods (/24)",max:110}];class Z extends n.Component{constructor(e){super(e),this.handleChangeNetwork=this.handleChangeNetwork.bind(this),this.handleLocationTypeChange=this.handleLocationTypeChange.bind(this),this.handleExtraZonesChange=this.handleExtraZonesChange.bind(this),this.handlePropChange=this.handlePropChange.bind(this)}handleLocationTypeChange(e){this.props.handleUpdateInput(Object.assign({},this.props.input,{locationType:e}))}handleExtraZonesChange(e){this.props.handleUpdateInput(Object.assign({},this.props.input,{extraZones:e}))}handleChangeNetwork(e){this.props.handleUpdateInput(Object.assign({},this.props.input,{network:e.target.value}))}handlePropChange(e,t){this.props.handleUpdateInput(Object.assign({},this.props.input,{[e]:t}))}render(){var e,t;return"MULTI_ZONAL"===this.props.input.locationType?(e=s.a.createElement(o.g,{for:"extra-zones-select",sm:2},"Extra Zones"),t=s.a.createElement(o.b,{sm:1},s.a.createElement(u,{name:"extra-zones-select",id:"extra-zones-select",options:L,value:this.props.input.extraZones,changeHandler:this.handleExtraZonesChange}))):(e=" ",t=" "),s.a.createElement(o.d,null,s.a.createElement(o.e,{row:!0},s.a.createElement(o.g,{for:"location-type-select",sm:3},"Location Type"),s.a.createElement(o.b,{sm:2},s.a.createElement(u,{name:"location-type-select",id:"location-type-select",options:P,value:this.props.input.locationType,changeHandler:this.handleLocationTypeChange})),e,t),s.a.createElement(o.e,{row:!0},s.a.createElement(o.g,{for:"network",sm:3}," ","Available Network"," ")," ",s.a.createElement(o.b,{sm:2},s.a.createElement(o.f,{name:"network",id:"network",type:"text",placeholder:"10.0.0.0",value:this.props.input.network,onChange:this.handleChangeNetwork})," ")," "),s.a.createElement(m,{name:"available-netmask",label:"Available Netmask",rules:this.props.inputRules.getAvailableNetmaskRules(),changeHandler:this.handlePropChange,value:this.props.input.netmask,propName:"netmask"}),s.a.createElement(m,{name:"node-netmask",label:"Node Subnet mask",rules:this.props.inputRules.getNodeRules(),changeHandler:this.handlePropChange,value:this.props.input.nodeNetmask,propName:"nodeNetmask"}),s.a.createElement(m,{name:"cluster-netmask",label:"Cluster Subnet mask",rules:this.props.inputRules.getClusterRules(),changeHandler:this.handlePropChange,value:this.props.input.clusterNetmask,propName:"clusterNetmask"}),s.a.createElement(g,{name:"node-pod-netmask-select",label:"Maximum Pods (Pod Netmask)",options:H,changeHandler:this.handlePropChange,value:this.props.input.nodePodNetmask,propName:"nodePodNetmask"}),s.a.createElement(m,{name:"service-netmask",label:"Service Subnet mask",rules:this.props.inputRules.getServiceRules(),changeHandler:this.handlePropChange,value:this.props.input.serviceNetmask,propName:"serviceNetmask"}),s.a.createElement(g,{name:"master-block-select",label:"Master CIDR block",options:_,changeHandler:this.handlePropChange,value:this.props.input.masterNetwork,propName:"masterNetwork"}))}}var j=Z;var G=class{static decToDot(e){return(e>>24&255)+"."+(e>>16&255)+"."+(e>>8&255)+"."+(255&e)}static dotToDec(e){var t=e.match(/(\d+)/g),a=0;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=Math.pow(2,8*(3-n));a+=t[n]*s}return a}static netEnd(e,t){var a=Math.pow(2,32-t)-1;return this.fixSigned(e|a)}static netStart(e,t){var a=4294967295-(Math.pow(2,32-t)-1);return this.fixSigned(e&a)}static findLargestMask(e,t){for(var a=t-e,n=0;n<32;){if(a<=Math.pow(2,n))return 32-n;n++}return NaN}static netmaskToDecimal(e){var t=Math.pow(2,32-e)-1;return this.fixSigned(4294967295^t)}static fixSigned(e){if(e<0){var t=2147483647&e;return t+=2147483648}return e}static netmaskToUsableIps(e){return Math.pow(2,32-e)}};var z=class{pack(e,t){for(var a=this.sortSubnets(t),n=G.netStart(G.dotToDec(e.net),e.mask),s=G.netEnd(n,e.mask),r=[],l=0;l<a.length;l++){var o=a[l],i=this.fit(n,s,o);if(!i.fit)return{state:"bad"};r.push({name:o.name,mask:o.mask,netStart:n,netEnd:i.end,description:o.description,vpcName:o.vpcName,subnetRangeName:o.subnetRangeName,type:o.type}),n=i.end+1}return{state:"ok",packedNets:r,freeRanges:this.findEmptyRanges(e,n)}}fit(e,t,a){var n=G.netEnd(e,a.mask);return n>t?{fit:!1,end:n}:{fit:!0,end:n}}sortSubnets(e){return e.sort((function(e,t){return e.mask===t.mask?e.name<t.name?-1:e.name>t.name?1:0:e.mask-t.mask}))}findEmptyRanges(e,t){for(var a=G.netStart(G.dotToDec(e.net),e.mask),n=G.netEnd(a,e.mask),s=a+(n-t),r=[],l=a,o=e.mask;o<32;o++){var i={mask:o},u=this.fit(l,s,i);u.fit&&(r.unshift({mask:o,netStart:n-u.end+a,netEnd:n-l+a}),l=u.end+1)}return r}};var V=class{constructor(e){for(var t=new z,a=[],n={net:e.network,mask:e.netmask},s=!0,r=1;s&&r<1001;){for(var l=[],o=r.toString().length,i=1;i<=r;i++)l.push({mask:e.nodeNetmask,name:"node-"+this.pad(o,i),vpcName:"vpc-"+this.pad(o,i),subnetRangeName:"N/A",type:"PRIMARY",description:"Main VPC range for node-"+this.pad(o,i)}),l.push({mask:e.clusterNetmask,name:"cluster-"+this.pad(o,i),vpcName:"vpc-"+this.pad(o,i),subnetRangeName:"cluster-"+this.pad(o,i),type:"SECONDARY",description:"Secondary range for VPC node-"+this.pad(o,i)+" (for pods)"}),l.push({mask:e.serviceNetmask,name:"service-"+this.pad(o,i),vpcName:"vpc-"+this.pad(o,i),subnetRangeName:"service-"+this.pad(o,i),type:"SECONDARY",description:"Secondary range for VPC node-"+this.pad(o,i)+" (for services)"}),"UNIQUE"===e.masterNetwork&&l.push({mask:28,name:"master-"+this.pad(o,i),vpcName:"N/A",subnetRangeName:"N/A",type:"MANAGED",description:"IP range for managed VPC for master(s) for cluster node-"+this.pad(o,i)});"SHARE"===e.masterNetwork&&l.push({mask:28,name:"master",vpcName:"N/A",subnetRangeName:"N/A",type:"MANAGED",description:"Shared IP range for managed VPC for master(s) for all clusters"});var u=t.pack(n,l);"ok"===u.state?a.push({networks:u.packedNets,freeRanges:u.freeRanges}):s=!1,r++}this.combinations=a}pad(e,t){return t.toString().padStart(e,"0")}getClusterRules(){return this.clusterRules}getNodeRules(){return this.nodeRules}getServiceRules(){return this.serviceRules}getCombinations(){return this.combinations}};class J extends n.Component{constructor(e){super(e),this.createOptions=()=>{var e=this.props.logic.getCombinations(),t=[];return e.forEach((function(e,a){t.push(s.a.createElement("option",{value:a,key:a},"Number of clusters: ",a+1," "))})),t},this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.changeHandler(Number(e.target.value))}render(){return s.a.createElement("div",null,s.a.createElement(o.e,{row:!0},s.a.createElement(o.g,{for:"combination",sm:2}," ","Available Combinations"," "),s.a.createElement(o.b,{sm:2},s.a.createElement(o.f,{type:"select",name:"combination",id:"exampleSelect",onChange:this.handleChange}," ",this.createOptions()," ")," ")," "))}}var Y=J;class B extends n.Component{subnetTypeText(e){return"PRIMARY"===e?"Primary":"SECONDARY"===e?"Secondary":"MANAGED"===e?"Google Managed":"N/A"}render(){return s.a.createElement("tr",null,s.a.createElement("td",null," ",G.decToDot(this.props.network.netStart),"/",this.props.network.mask),s.a.createElement("td",null," ",G.decToDot(this.props.network.netStart)," "),s.a.createElement("td",null," ",G.decToDot(this.props.network.netEnd)," "),s.a.createElement("td",null," ",this.props.network.name," "),s.a.createElement("td",null," ",this.props.network.vpcName," "),s.a.createElement("td",null," ",this.props.network.subnetRangeName," "),s.a.createElement("td",null," ",this.subnetTypeText(this.props.network.type)," "),s.a.createElement("td",null," ",this.props.network.description," "))}}var F=B;class W extends n.Component{render(){return s.a.createElement("tr",null,s.a.createElement("td",null," ",G.decToDot(this.props.network.netStart),"/",this.props.network.mask),s.a.createElement("td",null," ",G.decToDot(this.props.network.netStart)," "),s.a.createElement("td",null," ",G.decToDot(this.props.network.netEnd)," "),s.a.createElement("td",null," /",this.props.network.mask," "))}}var q=W;class Q{constructor(e){this.input=e}maximum(){var e=this.input.nodeNetmask;return G.netmaskToUsableIps(e)-4}ref(){return["https://cloud.google.com/vpc/docs/vpc#reserved_ip_addresses_in_every_subnet"]}}class K{constructor(e){this.input=e}maximum(){return G.netmaskToUsableIps(this.input.clusterNetmask)/G.netmaskToUsableIps(this.input.nodePodNetmask)}ref(){return[]}}class ${constructor(e,t){this.input=e,this.currentMax=t}maximum(){return"REGIONAL"===this.input.locationType?this.currentMax-this.currentMax%3:"MULTI_ZONAL"===this.input.locationType?this.currentMax-this.currentMax%(Number.parseInt(this.input.extraZones)+1):this.currentMax}ref(){return[]}}var X=class{constructor(e){this.input=e,this.nodeNetworkRules=new Q(this.input),this.clusterNetworkRules=new K(this.input)}maximum(){var e=this.nodeNetworkRules.maximum(),t=this.clusterNetworkRules.maximum();return new $(this.input,e<t?e:t).maximum()}details(){var e=[];return e.push({id:"subnet_limit",text:"The node subnet will limit each cluster to a maximum of ".concat(this.nodeNetworkRules.maximum()," node(s).")}),e.push({id:"cluster_limit",text:"The cluster subnet will limit each cluster to a maximum of ".concat(this.clusterNetworkRules.maximum()," node(s).")}),"REGIONAL"===this.input.locationType?e.push({id:"regional_multiple_limit",text:"Nodes in a regional cluster have to be deployed in multiples of three"}):"MULTI_ZONAL"===this.input.locationType&&e.push({id:"zonal_multiple_limit",text:"Nodes in a multi-zonal cluster (with ".concat(this.input.extraZones," extra zone) have to be deployed in multiples of ").concat(Number.parseInt(this.input.extraZones)+1)}),e}};var ee=class{constructor(e){this.input=e}maximum(){return G.netmaskToUsableIps(this.input.serviceNetmask)}};var te=class{constructor(e){this.input=e}maximum(){var e;for(e=0;e<H.length;++e)if(H[e].value===this.input.nodePodNetmask)return H[e].max;return NaN}};class ae extends n.Component{constructor(e){super(e),this.createDetail=e=>{var t=[];return e.details().forEach((e=>{t.push(s.a.createElement("div",{key:e.id},e.text))})),t},this.createRows=()=>{var e=this.props.logic.getCombinations()[this.state.output.combinationIndex].networks,t=[];return e.forEach((e=>{t.push(s.a.createElement(F,{key:e.name,network:e}))})),t},this.createFreeRows=()=>{var e=this.props.logic.getCombinations()[this.state.output.combinationIndex].freeRanges,t=[];return e.forEach((e=>{t.push(s.a.createElement(q,{key:e.netStart,network:e}))})),t},this.createTables=()=>this.props.logic.getCombinations().length<this.state.output.combinationIndex?s.a.createElement("div",null,s.a.createElement("h3",null," Invalid Combination Selected ")):s.a.createElement("div",null,s.a.createElement("h3",null," VPCs and Subnets required "),s.a.createElement(o.m,null,s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("th",null," Network "),s.a.createElement("th",null," Start "),s.a.createElement("th",null," End "),s.a.createElement("th",null," Name "),s.a.createElement("th",null," VPC Name "),s.a.createElement("th",null," Subnet Range Name "),s.a.createElement("th",null," Subnet Range Type "),s.a.createElement("th",null," Description ")),this.createRows()))," ",s.a.createElement("h3",null," Free Subnets "),s.a.createElement(o.m,null,s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("th",null," Network "),s.a.createElement("th",null," Start "),s.a.createElement("th",null," End "),s.a.createElement("th",null," Netmask ")),this.createFreeRows())));this.state={output:{combinationIndex:0}},this.handleUpdateOutput=this.handleUpdateOutput.bind(this),this.handleChangeCombination=this.handleChangeCombination.bind(this)}handleChangeCombination(e){this.handleUpdateOutput(Object.assign({},this.state.output,{combinationIndex:e}))}handleUpdateOutput(e){this.setState({output:e})}render(){var e=new X(this.props.input),t=new ee(this.props.input),a=new te(this.props.input);return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("b",null," Summary ")," ",s.a.createElement("br",null),"With the current configuration, up to"," ",this.props.logic.getCombinations().length," isolated clusters can be created. ",s.a.createElement("br",null),"Each cluster will suppport: ",s.a.createElement("br",null),"Up to ",e.maximum()," node(s) per cluster. ",s.a.createElement("br",null),"Up to ",t.maximum()," service(s) per cluster. ",s.a.createElement("br",null),"Up to ",a.maximum()," pods per node. ",s.a.createElement("br",null)),s.a.createElement("div",null,s.a.createElement("b",null,"Details"),s.a.createElement("br",null),this.createDetail(e)),s.a.createElement(Y,{logic:this.props.logic,changeHandler:this.handleChangeCombination})," ",this.createTables())}}var ne=ae;class se extends n.Component{printReslts(){return this.props.state.logic&&this.props.state.logic.getCombinations()&&this.props.state.logic.getCombinations().length>0?s.a.createElement(ne,{logic:this.props.state.logic,input:this.props.state.input}):s.a.createElement("div",null," Invalid Input ")}render(){return s.a.createElement("div",null,s.a.createElement("hr",null),s.a.createElement("h2",null," Results "),this.printReslts())}}var re=se;class le extends s.a.Component{constructor(e){super(e),this.state={downloadModal:!1,uploadModal:!1,configText:""},this.toggleDownload=this.toggleDownload.bind(this),this.toggleUpload=this.toggleUpload.bind(this),this.uploadConfig=this.uploadConfig.bind(this),this.handleConfigText=this.handleConfigText.bind(this)}handleConfigText(e){this.setState(Object.assign({},this.state.input,{configText:e.target.value}))}toggleDownload(){this.setState((e=>({downloadModal:!e.downloadModal,uploadModal:e.uploadModal,configText:""})))}toggleUpload(){this.setState((e=>({downloadModal:e.downloadModal,uploadModal:!e.uploadModal,configText:""})))}uploadConfig(){this.toggleUpload(),this.props.handleUploadConfig(this.state.configText)}render(){return s.a.createElement(o.b,{className:"text-right "},s.a.createElement(o.a,{color:"primary",onClick:this.toggleDownload},"Download Config")," ",s.a.createElement(o.h,{isOpen:this.state.downloadModal,toggle:this.toggleDownload},s.a.createElement(o.k,{toggle:this.toggleDownload},"Current Configuration"),s.a.createElement(o.i,null,s.a.createElement("pre",null,this.props.input)),s.a.createElement(o.j,null,s.a.createElement(o.a,{color:"secondary",onClick:this.toggleDownload},"Close"))),s.a.createElement(o.a,{color:"secondary",onClick:this.toggleUpload},"Upload Config")," ",s.a.createElement(o.h,{isOpen:this.state.uploadModal,toggle:this.toggleUpload},s.a.createElement(o.k,{toggle:this.toggleUpload},"Upload Configuration"),s.a.createElement(o.i,null,s.a.createElement(o.f,{type:"textarea",name:"text",id:"exampleText",rows:"15",onChange:this.handleConfigText})),s.a.createElement(o.j,null,s.a.createElement(o.a,{color:"primary",onClick:this.uploadConfig},"Upload"),s.a.createElement(o.a,{color:"secondary",onClick:this.toggleUpload},"Cancel"))))}}var oe=le;class ie extends n.Component{constructor(e){super(e);var t={network:"10.0.0.0",netmask:16,nodeNetmask:29,clusterNetmask:24,serviceNetmask:24,nodePodNetmask:"24",masterNetwork:"PUBLIC",locationType:"ZONAL",extraZones:1},a=new V(t),n=new D(t);this.state={input:t,logic:a,inputRules:n},this.handleUpdateInput=this.handleUpdateInput.bind(this),this.handleUploadConfig=this.handleUploadConfig.bind(this)}handleUploadConfig(e){var t=JSON.parse(e);this.handleUpdateInput(t)}handleUpdateInput(e){var t;this.validateInput(e)&&(t=new V(e)),this.setState({input:e,logic:t,inputRules:new D(e)})}validateInput(e){return!!Number.isInteger(e.netmask)}render(){return s.a.createElement("div",{className:"workspace"},s.a.createElement("br",null),s.a.createElement(o.c,null,s.a.createElement(o.l,null,s.a.createElement(oe,{input:JSON.stringify(this.state.input,null," "),handleUploadConfig:this.handleUploadConfig}))),s.a.createElement("br",null),s.a.createElement(j,{input:this.state.input,inputRules:this.state.inputRules,handleUpdateInput:this.handleUpdateInput}),s.a.createElement("hr",null),s.a.createElement("h2",null,"Input"),s.a.createElement("pre",null,JSON.stringify(this.state.input,null," ")),s.a.createElement(re,{state:this.state}))}}var ue=ie;class pe extends n.Component{render(){return s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},s.a.createElement("h1",null," GKE IP Address Management ")),s.a.createElement(ue,null))}}var he=pe;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(19);l.a.render(s.a.createElement(he,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()}))},5:function(e,t,a){}},[[20,1,2]]]);
//# sourceMappingURL=main.75371a7b.chunk.js.map